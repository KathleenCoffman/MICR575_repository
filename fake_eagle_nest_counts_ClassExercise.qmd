---
title: "Eagles data exercise"
format: gfm
editor: visual
---

## Tidy data class exercise using Eagles data

-   Use `read_csv()` to read the data into a data frame.

```{r}
getwd()
library(ggplot2, tidyr)
eagles_data <- read.csv("fake_eagle_nest_counts.csv")
```

-   Would you describe this as a "tidy" data frame? Why or why not?

    -   This data frame isn't too terribly untidy, but tidiness can be enhanced by using the pivot_longer function.

-   If not, "pivot" it to be a tidy data frame. Remember to use the names_to and values_to arguments to generate a new data frame that has logical column names.

    ```{r}
    library(tidyr)
    tidy_eagles_data <- eagles_data |>
      pivot_longer(cols = -year, 
                   names_to = "region", 
                   values_to = "quantity")

    # Rename the columns
    colnames(tidy_eagles_data) <- c("Year", "Region", "Nests")

    # Print data frame
    print(tidy_eagles_data)

    ```

-   Make a scatter plot of the resulting data, showing the number of eagles' nests in each region by year. Add a linear trend line using `geom_smooth(method="lm")`.Â 

```{r}
library(ggplot2)
custom_colors <- c("pacific" = "purple", "southwest" = "pink", "rocky.mtn" = "magenta")
ggplot(tidy_eagles_data, aes(x = Year, y = Nests, color = Region)) +
  geom_point() +
  geom_smooth(method = "lm") +
  labs(x = "Year", y = "Number of Eagle Nests", title = "Eagle Nests by Region Over Time") + 
  scale_color_manual(values = custom_colors)
                       ggsave(filename = "eagles_plot.png", device = "png")
```
